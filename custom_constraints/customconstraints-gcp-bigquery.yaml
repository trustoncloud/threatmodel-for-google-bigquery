# Control Bigquery.C119: Deny BigQuery Data Transfers from unauthorized data sources
name: organizations/ORG_ID/customConstraints/custom.bqDtsDenyDataSourceTransfers
resourceTypes:
- bigquerydatatransfer.googleapis.com/TransferConfig
methodTypes:
- CREATE
- UPDATE
condition: "!(resource.dataSourceId in ['authorizedSource1', 'authorizedSource2'])"
actionType: DENY
displayName: "Deny data transfers using unauthorized data sources"
description: "Deny creating or updating data transfers using unauthorized data sources"
---
# Control Bigquery.C119: Deny BigQuery Data Transfers with an unauthorized data destinations
name: organizations/ORG_ID/customConstraints/custom.bqDtsDenyDatasetDestinations
resourceTypes:
- bigquerydatatransfer.googleapis.com/TransferConfig
methodTypes:
- CREATE
- UPDATE
condition: "!(resource.destinationDatasetId in ['projects/{project}/datasets/{dataset1}', 'projects/{project}/datasets/{dataset2}'])"
actionType: DENY
displayName: "Deny data transfers using unauthorized dataset destinations"
description: "Deny creating or updating data transfers using unauthorized dataset destinations"
---
# Control Bigquery.C120: Deny BigQuery Data Transfers with an unauthorized transfer configuration
name: organizations/ORG_ID/customConstraints/custom.bqDtsDenyDataRefreshWindowDays
resourceTypes:
- bigquerydatatransfer.googleapis.com/TransferConfig
methodTypes:
- CREATE
- UPDATE
condition: "(resource.dataRefreshWindowDays == null) || resource.dataRefreshWindowDays != {Authorized Data Refresh Window Days}"
actionType: DENY
displayName: "Deny data transfers using unauthorized data refresh window days"
description: "Deny creating or updating data transfers using unauthorized data refresh window days"
---
# Control Bigquery.C120: Deny BigQuery Data Transfers with an unauthorized transfer configuration
name: organizations/ORG_ID/customConstraints/custom.bqDtsDenyDisabledFailureEmail
resourceTypes:
- bigquerydatatransfer.googleapis.com/TransferConfig
methodTypes:
- CREATE
- UPDATE
condition: resource.emailPreferences.enableFailureEmail != true 
actionType: DENY
displayName: "Deny data transfers using disabled failure email notifications"
description: "Deny creating or updating data transfers using disabled failure email notifications"
---
# Control Bigquery.C120: Deny BigQuery Data Transfers with an unauthorized transfer configuration
name: organizations/ORG_ID/customConstraints/custom.bqDtsDenyUnauthorizedSchedule
resourceTypes:
- bigquerydatatransfer.googleapis.com/TransferConfig
methodTypes:
- CREATE
- UPDATE
condition: "!resource.schedule.matches('{Authorized Schedule REGEX}')"
actionType: DENY
displayName: "Deny data transfers using an unauthorized schedule"
description: "Deny creating or updating data transfers using an unauthorized schedule"
---
# Control Bigquery.C120: Deny BigQuery Data Transfers with an unauthorized transfer configuration
name: organizations/ORG_ID/customConstraints/custom.bqDtsDenyUnauthorizedEventDrivenSchedule
resourceTypes:
- bigquerydatatransfer.googleapis.com/TransferConfig
methodTypes:
- CREATE
- UPDATE
condition: "!(resource.scheduleOptionsV2.eventDrivenSchedule.pubsubSubscription in ['projects/proj/subscriptions/sub1', 'projects/proj/subscriptions/sub2'])"
actionType: DENY
displayName: "Deny data transfers using unauthorized event-driven schedule"
description: "Deny creating or updating data transfers using unauthorized event-driven schedule"
---
# Control Bigquery.C123: Deny BigQuery Data Transfers using an unauthorized CMEK
name: organizations/ORG_ID/customConstraints/custom.bqDtsDenyUnauthorizedCMEK
resourceTypes:
- bigquerydatatransfer.googleapis.com/TransferConfig
methodTypes:
- CREATE
- UPDATE
condition: "!resource.encryptionConfiguration.kmsKeyName.matches('{Authorized CMEK Regex}')"
actionType: DENY
displayName: "Deny data transfers using an unauthorized CMEK key"
description: "Deny creating or updating data transfers using an unauthorized CMEK key"
